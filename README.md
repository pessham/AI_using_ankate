# AI活用診断ツール - 使い方マニュアル

## 📋 目次
1. [概要](#概要)
2. [セットアップ手順](#セットアップ手順)
3. [使い方](#使い方)
4. [カスタマイズ方法](#カスタマイズ方法)
5. [拡張設計](#拡張設計)
6. [トラブルシューティング](#トラブルシューティング)

---

## 📌 概要

このツールは、Googleスプレッドシートのアンケートデータを自動で分析し、企業のAI活用状況を可視化する診断レポートを生成します。

### 主な機能
- ✅ **4象限マトリクス**: 社員を4タイプに自動分類
- ✅ **リスク分析**: 情報漏洩リスクを可視化
- ✅ **部署別比較**: 部署ごとのAI活用状況を比較
- ✅ **診断レポート**: AI活用レベルと改善提案を自動生成
- ✅ **CTA機能**: 研修相談への導線

---

## 🚀 セットアップ手順

### ステップ1: Googleスプレッドシートの準備

1. **アンケートを実施**
   - Googleフォームでアンケートを作成
   - 回答を自動的にスプレッドシートに記録

2. **スプレッドシートの形式**
   
   必須列（以下の列名が必要）:
   ```
   - 社員ID
   - 部署
   - Q1.利用頻度
   - Q2.マインド
   - Q3.指示自信
   - Q4.見抜く自信
   - Q5.機密情報入力
   - Q6.著作権理解
   - X軸スコア (意欲)
   - Y軸スコア (スキル)
   ```

3. **スプレッドシートを公開**
   - スプレッドシートを開く
   - 右上の「共有」ボタンをクリック
   - 「リンクを知っている全員が閲覧可能」に変更
   - リンクをコピー

### ステップ2: HTMLファイルの設置

1. **ファイルをサーバーにアップロード**
   ```
   - ai-diagnosis-tool.html をWebサーバーにアップロード
   - または、ローカルでブラウザから直接開く
   ```

2. **デフォルトのスプレッドシートIDを設定（任意）**
   
   HTMLファイルの10行目付近:
   ```javascript
   const DEFAULT_SHEET_ID = 'あなたのスプレッドシートID';
   ```

### ステップ3: 動作確認

1. ブラウザで `ai-diagnosis-tool.html` を開く
2. スプレッドシートのURLを入力（または空欄でサンプルデータ）
3. 「診断を開始する」ボタンをクリック
4. 診断レポートが表示されることを確認

---

## 🎯 使い方

### 基本的な使い方

1. **トップページ**
   - ブラウザでHTMLファイルを開く
   - スプレッドシートのURL（またはID）を入力
   - 「診断を開始する」をクリック

2. **診断結果ページ**
   - AI活用レベルの確認
   - 4象限マトリクスで社員分類
   - リスク分析の確認
   - 部署別比較の確認
   - 提案内容の確認
   - 「30分無料相談を予約する」ボタンをクリック

### データの更新

- スプレッドシートにデータを追加
- ブラウザで再度「診断を開始する」をクリック
- 最新データで再分析

---

## 🎨 カスタマイズ方法

### 1. デザインのカスタマイズ

#### 色の変更

HTMLファイル内のCSSを編集:

```css
/* アクセントカラーを変更 */
.accent-color { color: #5cb85c; }  /* 緑 → 別の色に */
.accent-bg { background-color: #5cb85c; }
.accent-border { border-color: #5cb85c; }
```

#### ロゴの追加

ヘッダー部分（約280行目）を編集:

```html
<h1 className="text-2xl font-bold accent-color">
    <img src="logo.png" alt="ロゴ" className="h-8 inline-block mr-2" />
    AI活用診断レポート
</h1>
```

### 2. 会社情報のカスタマイズ

#### 会社名の変更

約280行目:
```html
<div className="text-sm text-gray-600">powered by 御社名</div>
```

#### フッター情報の変更

約960行目:
```html
<p>© 2024 御社名. All rights reserved.</p>
<p className="mt-2">お問い合わせ: your-email@example.com</p>
```

### 3. CTAボタンのリンク変更

約920行目:
```html
<a 
    href="https://あなたの予約ページURL" 
    target="_blank"
    className="..."
>
    30分無料相談を予約する 🎯
</a>
```

### 4. AI活用レベルの判定基準変更

約470行目付近のロジックを編集:

```javascript
let aiLevel = '関心先行型';
let aiLevelStars = 3;

if (leaderRate >= 30 && riskRate < 20) {
    aiLevel = '成熟期';
    aiLevelStars = 5;
}
// ...他の条件を追加・変更
```

---

## 🔧 拡張設計

このツールは拡張しやすいように設計されています。

### アーキテクチャ

```
┌─────────────────────────────────────┐
│  データ取得層                        │
│  - fetchSheetData()                 │
│  - parseCSV()                       │
└──────────────┬──────────────────────┘
               │
┌──────────────▼──────────────────────┐
│  データ分析層                        │
│  - analyzeData()                    │
│  - 4象限分類                         │
│  - リスク分析                        │
│  - 部署別集計                        │
└──────────────┬──────────────────────┘
               │
┌──────────────▼──────────────────────┐
│  可視化層                            │
│  - DiagnosisResults                 │
│  - Rechartsグラフ                    │
└─────────────────────────────────────┘
```

### 拡張例1: 質問項目の追加

スプレッドシートに列を追加するだけで、自動的にデータが読み込まれます。

新しい分析を追加する場合:

```javascript
// analyzeData関数に追加
const customAnalysis = {
    newMetric: data.filter(r => r['Q7.新しい質問'] === '特定の回答').length
};
```

### 拡張例2: 新しいグラフの追加

```javascript
// DiagnosisResults内に追加
<div className="bg-white rounded-lg shadow-lg p-8 mb-8">
    <h2 className="text-2xl font-bold mb-4">📊 新しい分析</h2>
    <ResponsiveContainer width="100%" height={300}>
        <LineChart data={yourData}>
            {/* グラフ設定 */}
        </LineChart>
    </ResponsiveContainer>
</div>
```

### 拡張例3: PDF出力機能

将来的に追加できる機能:

```javascript
// jsPDFライブラリを追加
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

// PDF出力ボタン
<button onClick={exportToPDF}>PDFで保存</button>
```

### 拡張例4: データベース連携

現在はGoogleスプレッドシートのみですが、将来的に拡張可能:

```javascript
// fetchSheetData関数を置き換え
const fetchDataFromAPI = async () => {
    const response = await fetch('https://your-api.com/data');
    return await response.json();
};
```

---

## ❓ トラブルシューティング

### Q1: データが読み込めない

**原因**: スプレッドシートが非公開

**解決策**:
1. スプレッドシートを開く
2. 「共有」→「リンクを知っている全員が閲覧可能」に変更
3. もう一度試す

---

### Q2: グラフが表示されない

**原因**: データ形式が正しくない

**解決策**:
1. スプレッドシートの列名を確認
2. 必須列がすべて存在するか確認
3. スコア列（X軸、Y軸）が数値になっているか確認

---

### Q3: 散布図の点が表示されない

**原因**: スコアが0または空白

**解決策**:
1. スプレッドシートのスコア列を確認
2. 数式が正しく計算されているか確認
3. 空白セルがないか確認

---

### Q4: 部署名が正しく表示されない

**原因**: スプレッドシートの部署名とコード内の定義が一致していない

**解決策**:
HTMLファイルの部署色定義を編集（約500行目）:

```javascript
const COLORS = {
    '営業部': '#5cb85c',
    '開発部': '#5bc0de',
    'マーケ部': '#f0ad4e',
    '管理部': '#d9534f',
    // 新しい部署を追加
    '新部署': '#9b59b6'
};
```

---

### Q5: ブラウザで「CORSエラー」が出る

**原因**: ローカルファイルからのアクセス制限

**解決策**:
1. Webサーバーにアップロードして使用
2. または、ローカルサーバーを立ち上げる:
   ```bash
   # Pythonの場合
   python -m http.server 8000
   
   # Node.jsの場合
   npx serve
   ```

---

## 📞 サポート

ご質問やカスタマイズのご相談は、以下までお問い合わせください:

- Email: support@example.com
- URL: https://example.com/support

---

## 📝 変更履歴

### v1.0.0 (2024-11-08)
- 初回リリース
- 4象限マトリクス、リスク分析、部署別比較機能を実装
- MVP版として拡張可能な設計

---

## 📄 ライセンス

このツールは商用利用可能です。
カスタマイズや再配布も自由に行えます。

---

**制作者**: AI活用診断ツール開発チーム  
**最終更新**: 2024年11月8日
